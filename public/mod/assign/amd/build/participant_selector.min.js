/**
 * Custom auto-complete adapter to load users from the assignment list_participants webservice.
 *
 * @module     mod_assign/participant_selector
 * @copyright  2015 Damyon Wiese <damyon@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_assign/participant_selector",["core/ajax","core/templates"],(function(ajax,templates){return{processResults:function(selector,data){return data},transport:function(selector,query,success,failure){const element=document.querySelector(selector);var assignmentid=element.getAttribute("data-assignmentid"),groupid=element.getAttribute("data-groupid"),filters=document.querySelectorAll('[data-region="configure-filters"] input[type="checkbox"]'),filterstrings=[];filters.forEach((e=>{let filterelement=document.querySelector(e);filterstrings[filterelement.getAttribute("name")]=filterelement.checked}));var marking=element.getAttribute("data-ismarking");ajax.call([{methodname:"mod_assign_list_participants",args:{assignid:assignmentid,groupid:groupid,filter:query,limit:30,includeenrolments:!1,tablesort:!0,marking:marking}}])[0].then((function(results){var promises=[],identityfields=document.querySelector("[data-showuseridentity]").dataset.showuseridentity.split(",");return results.forEach((user=>{var ctx=user,identity=[],show=!0;filterstrings.filter_submitted&&!user.submitted&&(show=!1),filterstrings.filter_notsubmitted&&user.submitted&&(show=!1),filterstrings.filter_requiregrading&&!user.requiregrading&&(show=!1),filterstrings.filter_grantedextension&&!user.grantedextension&&(show=!1),show&&(identityfields.forEach((k=>{void 0!==user[k]&&""!==user[k]&&(ctx.hasidentity=!0,identity.push(user[k]))})),ctx.identity=identity.join(", "),promises.push(templates.render("mod_assign/list_participant_user_summary",ctx).then((function(html){return{value:user.id,label:html}}))))})),Promise.all(promises)})).then((function(users){success(users)})).catch(failure)}}}));

//# sourceMappingURL=participant_selector.min.js.map